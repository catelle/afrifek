{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 136, "column": 0}, "map": {"version":3,"sources":["file:///home/catelle/afri-fek%20v1.2/frontend/src/app/api/resources/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server';\nimport { initializeApp } from 'firebase/app';\nimport { getFirestore, collection, getDocs } from 'firebase/firestore';\n\nconst firebaseConfig = {\n  apiKey: \"AIzaSyDVC4CqHBMSr9quu2q9lJODSfQvITAM-SQ\",\n  authDomain: \"afri-fek.firebaseapp.com\",\n  projectId: \"afri-fek\",\n  storageBucket: \"afri-fek.firebasestorage.app\",\n  messagingSenderId: \"1032447928128\",\n  appId: \"1:1032447928128:web:9fa19b789243f96f6d3ca5\"\n};\n\nconst app = initializeApp(firebaseConfig);\nconst db = getFirestore(app);\n\nlet cachedResources: any[] | null = null;\nlet cacheTimestamp: number = 0;\nconst CACHE_DURATION = 24 * 60 * 60 * 1000;\n\nexport async function GET() {\n  try {\n    const now = Date.now();\n    \n    if (cachedResources && (now - cacheTimestamp) < CACHE_DURATION) {\n      return NextResponse.json({ \n        resources: cachedResources,\n        cached: true\n      });\n    }\n\n    const [resourcesSnapshot, uploadedSnapshot] = await Promise.all([\n      getDocs(collection(db, 'resources')),\n      getDocs(collection(db, 'FormuploadedResult'))\n    ]);\n\n    const resources = resourcesSnapshot.docs.map(doc => ({\n      id: doc.id,\n      ...doc.data()\n    }));\n\n    const uploaded = uploadedSnapshot.docs.map(doc => ({\n      id: doc.id,\n      ...doc.data()\n    }));\n\n    const allResources = [...resources, ...uploaded];\n    const approved = allResources.filter(r => \n      r.status === 'approved' || !r.status || r.status === ''\n    );\n\n    cachedResources = approved;\n    cacheTimestamp = now;\n\n    return NextResponse.json({ \n      resources: approved,\n      count: approved.length\n    });\n  } catch (error) {\n    console.error('Error fetching resources:', error);\n    return NextResponse.json({ error: 'Failed to fetch resources' }, { status: 500 });\n  }\n}"],"names":[],"mappings":";;;;AAAA;AACA;AAAA;AACA;AAAA;;;;AAEA,MAAM,iBAAiB;IACrB,QAAQ;IACR,YAAY;IACZ,WAAW;IACX,eAAe;IACf,mBAAmB;IACnB,OAAO;AACT;AAEA,MAAM,MAAM,IAAA,uLAAa,EAAC;AAC1B,MAAM,KAAK,IAAA,mLAAY,EAAC;AAExB,IAAI,kBAAgC;AACpC,IAAI,iBAAyB;AAC7B,MAAM,iBAAiB,KAAK,KAAK,KAAK;AAE/B,eAAe;IACpB,IAAI;QACF,MAAM,MAAM,KAAK,GAAG;QAEpB,IAAI,mBAAmB,AAAC,MAAM,iBAAkB,gBAAgB;YAC9D,OAAO,4JAAY,CAAC,IAAI,CAAC;gBACvB,WAAW;gBACX,QAAQ;YACV;QACF;QAEA,MAAM,CAAC,mBAAmB,iBAAiB,GAAG,MAAM,QAAQ,GAAG,CAAC;YAC9D,IAAA,8KAAO,EAAC,IAAA,iLAAU,EAAC,IAAI;YACvB,IAAA,8KAAO,EAAC,IAAA,iLAAU,EAAC,IAAI;SACxB;QAED,MAAM,YAAY,kBAAkB,IAAI,CAAC,GAAG,CAAC,CAAA,MAAO,CAAC;gBACnD,IAAI,IAAI,EAAE;gBACV,GAAG,IAAI,IAAI,EAAE;YACf,CAAC;QAED,MAAM,WAAW,iBAAiB,IAAI,CAAC,GAAG,CAAC,CAAA,MAAO,CAAC;gBACjD,IAAI,IAAI,EAAE;gBACV,GAAG,IAAI,IAAI,EAAE;YACf,CAAC;QAED,MAAM,eAAe;eAAI;eAAc;SAAS;QAChD,MAAM,WAAW,aAAa,MAAM,CAAC,CAAA,IACnC,EAAE,MAAM,KAAK,cAAc,CAAC,EAAE,MAAM,IAAI,EAAE,MAAM,KAAK;QAGvD,kBAAkB;QAClB,iBAAiB;QAEjB,OAAO,4JAAY,CAAC,IAAI,CAAC;YACvB,WAAW;YACX,OAAO,SAAS,MAAM;QACxB;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,6BAA6B;QAC3C,OAAO,4JAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAA4B,GAAG;YAAE,QAAQ;QAAI;IACjF;AACF"}}]
}